{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"E:\\\\xhl\\\\0.1012\\\\cangku\\\\backend\\\\benlai\\\\src\\\\page\\\\login.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect } from 'react';\nimport SHA256 from 'crypto-js/sha256';\nimport { Form, Input, Button, Checkbox, message } from 'antd';\nimport './login.scss';\nimport { login } from '../utils/api'; // import axios from 'axios'\n\nfunction setCookie(key, val, iday) {\n  //key 键名，val 键值， iday 多少天后失效\n  let time = new Date();\n  let today = time.getDate(); //日\n\n  time.setDate(today + iday);\n  document.cookie = key + '=' + val + ';expires=' + time + ';path=/';\n} //获取Cookie\n\n\nfunction getCookie(key) {\n  let str = document.cookie; // console.log(str);//name=小虎; age=18; adr=广东广州\n\n  let arr = str.split('; '); // console.log(arr);\n\n  for (let item of arr) {\n    let arr2 = item.split('=');\n\n    if (key == arr2[0]) {\n      return arr2[1];\n    }\n  }\n}\n\nfunction Login(props) {\n  _s();\n\n  const layout = {\n    labelCol: {\n      span: 6\n    },\n    wrapperCol: {\n      span: 16\n    }\n  };\n  const tailLayout = {\n    wrapperCol: {\n      offset: 6,\n      span: 16\n    }\n  };\n  const rules = {\n    name: [{\n      required: true,\n      message: '用户名不能为空'\n    }],\n    pwd: [{\n      required: true,\n      message: '密码不能为空'\n    }, {\n      min: 6,\n      max: 12,\n      message: '密码长度为6到12位'\n    }]\n  };\n  useEffect(() => {\n    if (getCookie('token')) {\n      props.history.push('/home');\n    }\n  }, []);\n\n  const onFinish = async values => {\n    // console.log(values);\n    values.pwd = SHA256(values.password).toString();\n    console.log(values); // //登录\n\n    const data = await login({\n      name: values.name,\n      pwd: values.pwd\n    });\n    console.log(data);\n\n    if (data.code === 2005) {\n      message.success('登录成功'); //把用户信息存入redux\n      // const action = { type: 'login', user: data.data }\n      // store.dispatch(action)\n      // console.log('newstate=', store.getState());\n      // const actions = { type: 'update_user', user: { phone: 13888888888, password: 123456 } }\n      // store.dispatch(actions)\n      // console.log('actions=', store.getState());\n      // props.dispatch({ type: 'login', user: data.data })\n      // console.log('loginprops=', props);\n      // props.login(data.data)\n      //redux-saga\n      // props.dispatch({ type: 'login_async', data: values })\n      //获取到高阶组件传过来的组件名称（通过props.location.search 提取）\n      // console.log('login-props', props.location.search);//?targeturl=add\n      // const pathname = props.location.search.match(/targeturl\\=([\\/\\w\\-]+)/);\n      // console.log(pathname);\n      // let paths;\n      // if (pathname) {\n      //     paths = pathname[1]\n      // }\n      //下次免登录 把token存到本地浏览器\n\n      if (values.remember) {\n        // localStorage.setItem('token', JSON.stringify(data.token))\n        setCookie('token', data.token, 7);\n      } else {\n        // sessionStorage.setItem('user', JSON.stringify(data.token))\n        setCookie('token', data.token, -1);\n      }\n\n      props.history.push('/home');\n    } else {\n      message.error('登录失败');\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"login\",\n    style: {\n      background: \"url('./logo.jpg')\"\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"box\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        style: {\n          color: 'blue',\n          fontSize: 50\n        },\n        children: \"\\u672C\\u6765\\u751F\\u6D3B\\u7F51\\u540E\\u53F0\\u7CFB\\u7EDF\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Form, { ...layout,\n        name: \"basic\",\n        initialValues: {\n          remember: true\n        },\n        onFinish: onFinish // onFinishFailed={onFinishFailed}\n        ,\n        children: [/*#__PURE__*/_jsxDEV(Form.Item, {\n          label: \"\\u7528\\u6237\\u540D\",\n          name: \"name\",\n          rules: rules.name,\n          hasFeedback: true,\n          children: /*#__PURE__*/_jsxDEV(Input, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n          label: \"\\u5BC6\\u7801\",\n          name: \"pwd\",\n          rules: rules.pwd,\n          children: /*#__PURE__*/_jsxDEV(Input.Password, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Item, { ...tailLayout,\n          name: \"remember\",\n          valuePropName: \"checked\",\n          children: /*#__PURE__*/_jsxDEV(Checkbox, {\n            children: \"\\u4E03\\u5929\\u514D\\u767B\\u5F55\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Item, { ...tailLayout,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            type: \"primary\",\n            htmlType: \"submit\",\n            children: \"\\u767B\\u5F55\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 144,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 108,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Login, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["E:/xhl/0.1012/cangku/backend/benlai/src/page/login.js"],"names":["React","useEffect","SHA256","Form","Input","Button","Checkbox","message","login","setCookie","key","val","iday","time","Date","today","getDate","setDate","document","cookie","getCookie","str","arr","split","item","arr2","Login","props","layout","labelCol","span","wrapperCol","tailLayout","offset","rules","name","required","pwd","min","max","history","push","onFinish","values","password","toString","console","log","data","code","success","remember","token","error","background","color","fontSize"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react'\r\nimport SHA256 from 'crypto-js/sha256'\r\nimport { Form, Input, Button, Checkbox, message } from 'antd';\r\n\r\n\r\nimport './login.scss'\r\nimport { login } from '../utils/api'\r\n// import axios from 'axios'\r\n\r\n\r\n\r\nfunction setCookie(key, val, iday) {\r\n    //key 键名，val 键值， iday 多少天后失效\r\n    let time = new Date();\r\n    let today = time.getDate();//日\r\n    time.setDate(today + iday);\r\n    document.cookie = key + '=' + val + ';expires=' + time + ';path=/';\r\n}\r\n//获取Cookie\r\nfunction getCookie(key) {\r\n    let str = document.cookie;\r\n    // console.log(str);//name=小虎; age=18; adr=广东广州\r\n    let arr = str.split('; ');\r\n    // console.log(arr);\r\n    for (let item of arr) {\r\n        let arr2 = item.split('=');\r\n        if (key == arr2[0]) {\r\n            return arr2[1];\r\n        }\r\n    }\r\n}\r\nfunction Login(props) {\r\n    const layout = {\r\n        labelCol: { span: 6 },\r\n        wrapperCol: { span: 16 },\r\n    };\r\n    const tailLayout = {\r\n        wrapperCol: { offset: 6, span: 16 },\r\n    };\r\n    const rules = {\r\n        name: [\r\n            { required: true, message: '用户名不能为空' },\r\n        ],\r\n        pwd: [\r\n            { required: true, message: '密码不能为空' },\r\n            { min: 6, max: 12, message: '密码长度为6到12位' }\r\n\r\n        ]\r\n    }\r\n    useEffect(() => {\r\n        if (getCookie('token')) {\r\n            props.history.push('/home')\r\n        }\r\n    }, [])\r\n    const onFinish = async (values) => {\r\n        // console.log(values);\r\n        values.pwd = SHA256(values.password).toString()\r\n        console.log(values);\r\n        // //登录\r\n        const data = await login({\r\n            name: values.name,\r\n            pwd: values.pwd\r\n        })\r\n        console.log(data);\r\n        if (data.code === 2005) {\r\n            message.success('登录成功')\r\n\r\n            //把用户信息存入redux\r\n            // const action = { type: 'login', user: data.data }\r\n            // store.dispatch(action)\r\n            // console.log('newstate=', store.getState());\r\n            // const actions = { type: 'update_user', user: { phone: 13888888888, password: 123456 } }\r\n            // store.dispatch(actions)\r\n            // console.log('actions=', store.getState());\r\n\r\n            // props.dispatch({ type: 'login', user: data.data })\r\n\r\n\r\n            // console.log('loginprops=', props);\r\n            // props.login(data.data)\r\n            //redux-saga\r\n            // props.dispatch({ type: 'login_async', data: values })\r\n            //获取到高阶组件传过来的组件名称（通过props.location.search 提取）\r\n            // console.log('login-props', props.location.search);//?targeturl=add\r\n            // const pathname = props.location.search.match(/targeturl\\=([\\/\\w\\-]+)/);\r\n            // console.log(pathname);\r\n            // let paths;\r\n            // if (pathname) {\r\n            //     paths = pathname[1]\r\n            // }\r\n            //下次免登录 把token存到本地浏览器\r\n            if (values.remember) {\r\n                // localStorage.setItem('token', JSON.stringify(data.token))\r\n\r\n                setCookie('token', data.token, 7);\r\n            } else {\r\n                // sessionStorage.setItem('user', JSON.stringify(data.token))\r\n                setCookie('token', data.token, -1);\r\n            }\r\n            props.history.push('/home')\r\n\r\n        } else {\r\n            message.error('登录失败')\r\n        }\r\n\r\n    }\r\n    return (\r\n        <div className=\"login\" style={{\r\n            background: \"url('./logo.jpg')\"\r\n        }}>\r\n            <div className=\"box\">\r\n                <h1 style={{ color: 'blue', fontSize: 50 }}>本来生活网后台系统</h1>\r\n                <Form\r\n                    {...layout}\r\n                    name=\"basic\"\r\n                    initialValues={{ remember: true }}\r\n\r\n                    onFinish={onFinish}\r\n                // onFinishFailed={onFinishFailed}\r\n                >\r\n                    <Form.Item\r\n                        label=\"用户名\"\r\n                        name=\"name\"\r\n                        rules={rules.name}\r\n                        hasFeedback\r\n                    >\r\n                        <Input />\r\n                    </Form.Item>\r\n\r\n                    <Form.Item\r\n                        label=\"密码\"\r\n                        name=\"pwd\"\r\n                        rules={rules.pwd}\r\n\r\n                    >\r\n                        <Input.Password />\r\n                    </Form.Item>\r\n\r\n                    <Form.Item {...tailLayout} name=\"remember\" valuePropName=\"checked\">\r\n                        <Checkbox>七天免登录</Checkbox>\r\n                    </Form.Item>\r\n\r\n                    <Form.Item {...tailLayout}>\r\n                        <Button type=\"primary\" htmlType=\"submit\">\r\n                            登录\r\n                </Button>\r\n                    </Form.Item>\r\n                </Form>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Login\r\n"]},"metadata":{},"sourceType":"module"}